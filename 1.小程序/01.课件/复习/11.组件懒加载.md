# 组件懒加载

1. 前言:
   1. 请问Vue项目中,如果不存在大文件的情况,那么请问以生产环境打包之后,得到的dist文件夹中具有哪几个文件?
      1. index.html
      2. index.js
      3. 总结:
         1. 也就是说组件中的样式代码和使用到的小图片都会被打包进入到index.js中
            1. 图片会被转换成base64格式,而css样式会被编译成js版本的css代码,最终通过style标签插入到页面上
         2. 也就是说index.js中具有所有组价的代码
   2. 假设现在有一个项目,该项目具有10个组件,每个组件大小1MB
      1. 由于index.js中会具有所有组件的代码,那么此时index.js文件大小为10MB
      2. 流程:
         1. 浏览器输入url链接,从而请求服务器对应的index.html资源
         2. 服务器返回index.html资源,浏览器开始解析html
         3. 浏览器发现html文件中需要加载index.js文件,从而再请求服务器对应的index.js资源
         4. 服务器返回index.js资源,浏览器开始解析js
         5. js根据当前浏览器路由情况,显示对应的路由组件
      3. 问题:用户明明只管看了首页的内容,但是由于index.js文件中具有所有组件的代码,所以相当于一次性加载了所有组件的代码
         1. 用户只需要首页组件代码,结果却请求了所有组件的代码,**导致占用更多的网络带宽,同时增加了解析代码花费的时间,最终导致首页白屏时间增加,降低了页面的渲染速度**
   3. ES6模块化语法
      1. import...from 地址
         1. 静态引入
         2. 以当前方式引入代码,在最终编译代码的时候,会将对应的代码拷贝到当前文件中,替换掉该引入语法
         3. 也就是说,该语法在项目上线之后,将不会存在
      2. import(地址)
         1. 动态引入
         2. 以当前方式引入代码,在最终编译代码的时候,webpack遇到当前函数,不会去拷贝对应文件的代码,会将对应文件的代码单独切割为一个js文件存放
            1. 如果使用该方法引入组件,该组件就会单独存在,独立于index.js文件之外
         3. 也就是说,该语法在项目上线之后,依旧存在
2. 组件懒加载的优缺点
   1. 优点:经过了组件懒加载之后,之前index.js文件中的许多组件的代码都被切割出来了,**导致index.js文件大小变小,从而导致占用的带宽减少,同时减少解析代码花费的时间,最终导致首页白屏时间减少,提高首页的渲染速度**
   2. 缺点:经过了组件懒加载之后,由于index.js文件中没有其余组件的代码,那么当需要切换组件的时候,**需要重新发送请求获取服务器对应的组件代码,导致页面请求次数增加,从而导致后续页面的展示都会变慢,降低了后续页面的渲染速度**
      1. 其实就是将首页白屏的时间分配到每个页面首次展示去了
3. 组件预加载
   1. 由于组件懒加载的缺点,会导致后续页面的首次渲染都要发送请求,获取文件之后才能渲染,所以可以使用组件预加载来解决这个缺点
   2. 原理:趁用户不注意的时候,偷偷的请求未来可能需要使用的组件代码,将其存放于浏览器的内容中
      1. 那么当用户跳转对应组件时,会发现代码已经存在于内存中,不需要等待发送请求的时间
   3. 优缺点:
      1. 优点:让用户不再需要等待后续页面的请求过程时间,可以快速展示后续其他页面的操作
      2. 缺点:相比于懒加载之前的index.js,懒加载之后的所有文件总和体积会更大,也就是**会更加耗费流量**